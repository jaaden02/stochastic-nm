============================================================
FOKKER-PLANCK SETUP VALIDATION
============================================================
Grid: 150×40×40 (0.2 M cells)
Resolutions: dx=1.208 (Req < 0.8), dz=0.179, dφ=0.161
Initial Pos: x=0.0, z=-2.0, φ=-0.50π
Initial Widths: σx=0.10, σz=0.359, σφ=0.322
----------------------------------------
============================================================
VECTORIZED 3D FOKKER-PLANCK SOLVER
============================================================
Grid: 150×40×40 = 240,000 cells
Resolution: dx=1.208, dz=0.179, dφ=0.161
x in [0, 180], z in [-7, 0], φ in [-1.5707963267948966, 4.71238898038469]
Diffusion D0 = 1e-05
Initial ∫f = 1.000000

Time: t ∈ [0, 2000], dt=1.0000e-01, Nt=20001
Total Memory needed: 19.20 GB (float32)
------------------------------
CFL Stability Analysis (dt = 1.00e-01)
------------------------------
Advection Limits (dt < ...):
  X:   5.75e+00 (v=2.10e-01)
  Z:   1.63e+00 (v=1.10e-01)
  Phi: 2.65e+00 (v=6.08e-02) <--- Check this!
Diffusion Limits (dt < ...):
  Phi: 1.30e+03
------------------------------
Combined Max Stable dt: 8.58e-01
✅ STABLE

Allocating solution array: 184.0 MB
Starting Solver. BCs: X='open', Z='open'. Steps: 20001
Step 1/20000, t=0.0000, ∫f=1.000000
Step 100/20000, t=9.9000, ∫f=0.999997
Step 200/20000, t=19.9000, ∫f=0.999926
Step 300/20000, t=29.9000, ∫f=0.999677
Step 400/20000, t=39.9000, ∫f=0.998968
Step 500/20000, t=49.9000, ∫f=0.997679
Step 600/20000, t=59.9000, ∫f=0.995497
Step 700/20000, t=69.9000, ∫f=0.992347
Step 800/20000, t=79.9000, ∫f=0.988032
Step 900/20000, t=89.9000, ∫f=0.982514
Step 1000/20000, t=99.9000, ∫f=0.975736
Step 1100/20000, t=109.9000, ∫f=0.967702
Step 1200/20000, t=119.9000, ∫f=0.958452
Step 1300/20000, t=129.9000, ∫f=0.948040
Step 1400/20000, t=139.9000, ∫f=0.936560
Step 1500/20000, t=149.9000, ∫f=0.924102
Step 1600/20000, t=159.9000, ∫f=0.910784
Step 1700/20000, t=169.9000, ∫f=0.896716
Step 1800/20000, t=179.9000, ∫f=0.882022
Step 1900/20000, t=189.9000, ∫f=0.866816
Step 2000/20000, t=199.9000, ∫f=0.851215
Step 2100/20000, t=209.9000, ∫f=0.835325
Step 2200/20000, t=219.9000, ∫f=0.819248
Step 2300/20000, t=229.9000, ∫f=0.803077
Step 2400/20000, t=239.9000, ∫f=0.786898
Step 2500/20000, t=249.9000, ∫f=0.770785
Step 2600/20000, t=259.9000, ∫f=0.754807
Step 2700/20000, t=269.9000, ∫f=0.739021
Step 2800/20000, t=279.9000, ∫f=0.723477
Step 2900/20000, t=289.9000, ∫f=0.708218
Step 3000/20000, t=299.9000, ∫f=0.693278
Step 3100/20000, t=309.9000, ∫f=0.678687
Step 3200/20000, t=319.9000, ∫f=0.664467
Step 3300/20000, t=329.9000, ∫f=0.650635
Step 3400/20000, t=339.9000, ∫f=0.637202
Step 3500/20000, t=349.9000, ∫f=0.624178
Step 3600/20000, t=359.9000, ∫f=0.611566
Step 3700/20000, t=369.9000, ∫f=0.599368
Step 3800/20000, t=379.9000, ∫f=0.587582
Step 3900/20000, t=389.9000, ∫f=0.576204
Step 4000/20000, t=399.9000, ∫f=0.565229
Step 4100/20000, t=409.9000, ∫f=0.554648
Step 4200/20000, t=419.9000, ∫f=0.544455
Step 4300/20000, t=429.9000, ∫f=0.534639
Step 4400/20000, t=439.9000, ∫f=0.525189
Step 4500/20000, t=449.9000, ∫f=0.516094
Step 4600/20000, t=459.9000, ∫f=0.507344
Step 4700/20000, t=469.9000, ∫f=0.498927
Step 4800/20000, t=479.9000, ∫f=0.490829
Step 4900/20000, t=489.9000, ∫f=0.483041
Step 5000/20000, t=499.9000, ∫f=0.475549
Step 5100/20000, t=509.9000, ∫f=0.468342
Step 5200/20000, t=519.9000, ∫f=0.461408
Step 5300/20000, t=529.9000, ∫f=0.454736
Step 5400/20000, t=539.9000, ∫f=0.448313
Step 5500/20000, t=549.9000, ∫f=0.442130
Step 5600/20000, t=559.9000, ∫f=0.436176
Step 5700/20000, t=569.9000, ∫f=0.430439
Step 5800/20000, t=579.9000, ∫f=0.424909
Step 5900/20000, t=589.9000, ∫f=0.419577
Step 6000/20000, t=599.9000, ∫f=0.414432
Step 6100/20000, t=609.9000, ∫f=0.409466
Step 6200/20000, t=619.9000, ∫f=0.404669
Step 6300/20000, t=629.9000, ∫f=0.400032
Step 6400/20000, t=639.9000, ∫f=0.395546
Step 6500/20000, t=649.9000, ∫f=0.391204
Step 6600/20000, t=659.9000, ∫f=0.386996
Step 6700/20000, t=669.9000, ∫f=0.382916
Step 6800/20000, t=679.9000, ∫f=0.378956
Step 6900/20000, t=689.9000, ∫f=0.375109
Step 7000/20000, t=699.9000, ∫f=0.371368
Step 7100/20000, t=709.9000, ∫f=0.367725
Step 7200/20000, t=719.9000, ∫f=0.364176
Step 7300/20000, t=729.9000, ∫f=0.360713
Step 7400/20000, t=739.9000, ∫f=0.357330
Step 7500/20000, t=749.9000, ∫f=0.354023
Step 7600/20000, t=759.9000, ∫f=0.350786
Step 7700/20000, t=769.9000, ∫f=0.347614
Step 7800/20000, t=779.9000, ∫f=0.344503
Step 7900/20000, t=789.9000, ∫f=0.341447
Step 8000/20000, t=799.9000, ∫f=0.338443
Step 8100/20000, t=809.9000, ∫f=0.335487
Step 8200/20000, t=819.9000, ∫f=0.332574
Step 8300/20000, t=829.9000, ∫f=0.329703
Step 8400/20000, t=839.9000, ∫f=0.326869
Step 8500/20000, t=849.9000, ∫f=0.324069
Step 8600/20000, t=859.9000, ∫f=0.321302
Step 8700/20000, t=869.9000, ∫f=0.318564
Step 8800/20000, t=879.9000, ∫f=0.315853
Step 8900/20000, t=889.9000, ∫f=0.313167
Step 9000/20000, t=899.9000, ∫f=0.310505
Step 9100/20000, t=909.9000, ∫f=0.307864
Step 9200/20000, t=919.9000, ∫f=0.305244
Step 9300/20000, t=929.9000, ∫f=0.302642
Step 9400/20000, t=939.9000, ∫f=0.300058
Step 9500/20000, t=949.9000, ∫f=0.297490
Step 9600/20000, t=959.9000, ∫f=0.294938
Step 9700/20000, t=969.9000, ∫f=0.292401
Step 9800/20000, t=979.9000, ∫f=0.289879
Step 9900/20000, t=989.9000, ∫f=0.287371
Step 10000/20000, t=999.9000, ∫f=0.284876
Step 10100/20000, t=1009.9000, ∫f=0.282394
Step 10200/20000, t=1019.9000, ∫f=0.279925
Step 10300/20000, t=1029.9000, ∫f=0.277469
Step 10400/20000, t=1039.9000, ∫f=0.275025
Step 10500/20000, t=1049.9000, ∫f=0.272594
Step 10600/20000, t=1059.9000, ∫f=0.270176
Step 10700/20000, t=1069.9000, ∫f=0.267771
Step 10800/20000, t=1079.9000, ∫f=0.265378
Step 10900/20000, t=1089.9000, ∫f=0.262999
Step 11000/20000, t=1099.9000, ∫f=0.260633
Step 11100/20000, t=1109.9000, ∫f=0.258280
Step 11200/20000, t=1119.9000, ∫f=0.255941
Step 11300/20000, t=1129.9000, ∫f=0.253616
Step 11400/20000, t=1139.9000, ∫f=0.251306
Step 11500/20000, t=1149.9000, ∫f=0.249009
Step 11600/20000, t=1159.9000, ∫f=0.246728
Step 11700/20000, t=1169.9000, ∫f=0.244462
Step 11800/20000, t=1179.9000, ∫f=0.242212
Step 11900/20000, t=1189.9000, ∫f=0.239977
Step 12000/20000, t=1199.9000, ∫f=0.237759
Step 12100/20000, t=1209.9000, ∫f=0.235556
Step 12200/20000, t=1219.9000, ∫f=0.233371
Step 12300/20000, t=1229.9000, ∫f=0.231203
Step 12400/20000, t=1239.9000, ∫f=0.229051
Step 12500/20000, t=1249.9000, ∫f=0.226918
Step 12600/20000, t=1259.9000, ∫f=0.224802
Step 12700/20000, t=1269.9000, ∫f=0.222704
Step 12800/20000, t=1279.9000, ∫f=0.220624
Step 12900/20000, t=1289.9000, ∫f=0.218563
Step 13000/20000, t=1299.9000, ∫f=0.216520
Step 13100/20000, t=1309.9000, ∫f=0.214496
Step 13200/20000, t=1319.9000, ∫f=0.212491
Step 13300/20000, t=1329.9000, ∫f=0.210506
Step 13400/20000, t=1339.9000, ∫f=0.208539
Step 13500/20000, t=1349.9000, ∫f=0.206592
Step 13600/20000, t=1359.9000, ∫f=0.204665
Step 13700/20000, t=1369.9000, ∫f=0.202757
Step 13800/20000, t=1379.9000, ∫f=0.200869
Step 13900/20000, t=1389.9000, ∫f=0.199000
Step 14000/20000, t=1399.9000, ∫f=0.197151
Step 14100/20000, t=1409.9000, ∫f=0.195322
Step 14200/20000, t=1419.9000, ∫f=0.193513
Step 14300/20000, t=1429.9000, ∫f=0.191723
Step 14400/20000, t=1439.9000, ∫f=0.189953
Step 14500/20000, t=1449.9000, ∫f=0.188202
Step 14600/20000, t=1459.9000, ∫f=0.186471
Step 14700/20000, t=1469.9000, ∫f=0.184759
Step 14800/20000, t=1479.9000, ∫f=0.183066
Step 14900/20000, t=1489.9000, ∫f=0.181391
Step 15000/20000, t=1499.9000, ∫f=0.179735
Step 15100/20000, t=1509.9000, ∫f=0.178097
Step 15200/20000, t=1519.9000, ∫f=0.176477
Step 15300/20000, t=1529.9000, ∫f=0.174874
Step 15400/20000, t=1539.9000, ∫f=0.173287
Step 15500/20000, t=1549.9000, ∫f=0.171716
Step 15600/20000, t=1559.9000, ∫f=0.170160
Step 15700/20000, t=1569.9000, ∫f=0.168617
Step 15800/20000, t=1579.9000, ∫f=0.167088
Step 15900/20000, t=1589.9000, ∫f=0.165570
Step 16000/20000, t=1599.9000, ∫f=0.164062
Step 16100/20000, t=1609.9000, ∫f=0.162563
Step 16200/20000, t=1619.9000, ∫f=0.161070
Step 16300/20000, t=1629.9000, ∫f=0.159583
Step 16400/20000, t=1639.9000, ∫f=0.158097
Step 16500/20000, t=1649.9000, ∫f=0.156612
Step 16600/20000, t=1659.9000, ∫f=0.155125
Step 16700/20000, t=1669.9000, ∫f=0.153630
Step 16800/20000, t=1679.9000, ∫f=0.152130
Step 16900/20000, t=1689.9000, ∫f=0.150612
Step 17000/20000, t=1699.9000, ∫f=0.149085
Step 17100/20000, t=1709.9000, ∫f=0.147534
Step 17200/20000, t=1719.9000, ∫f=0.145960
Step 17300/20000, t=1729.9000, ∫f=0.144363
Step 17400/20000, t=1739.9000, ∫f=0.142725
Step 17500/20000, t=1749.9000, ∫f=0.141062
Step 17600/20000, t=1759.9000, ∫f=0.139350
Step 17700/20000, t=1769.9000, ∫f=0.137596
Step 17800/20000, t=1779.9000, ∫f=0.135799
Step 17900/20000, t=1789.9000, ∫f=0.133935
Step 18000/20000, t=1799.9000, ∫f=0.132032
Step 18100/20000, t=1809.9000, ∫f=0.130052
Step 18200/20000, t=1819.9000, ∫f=0.128017
Step 18300/20000, t=1829.9000, ∫f=0.125920
Step 18400/20000, t=1839.9000, ∫f=0.123736
Step 18500/20000, t=1849.9000, ∫f=0.121507
Step 18600/20000, t=1859.9000, ∫f=0.119178
Step 18700/20000, t=1869.9000, ∫f=0.116795
Step 18800/20000, t=1879.9000, ∫f=0.114335
Step 18900/20000, t=1889.9000, ∫f=0.111787
Step 19000/20000, t=1899.9000, ∫f=0.109199
Step 19100/20000, t=1909.9000, ∫f=0.106503
Step 19200/20000, t=1919.9000, ∫f=0.103772
Step 19300/20000, t=1929.9000, ∫f=0.100962
Step 19400/20000, t=1939.9000, ∫f=0.098086
Step 19500/20000, t=1949.9000, ∫f=0.095185
Step 19600/20000, t=1959.9000, ∫f=0.092192
Step 19700/20000, t=1969.9000, ∫f=0.089199
Step 19800/20000, t=1979.9000, ∫f=0.086141
Step 19900/20000, t=1989.9000, ∫f=0.083059
Step 20000/20000, t=1999.9000, ∫f=0.079977

============================================================
✓ Done! Solution shape: (201, 150, 40, 40)
Final ∫f = 0.079977
Computation time: 970.33 seconds
   (0.0485 sec/step, 4.95 Mcells/sec)
============================================================

Generating summary plots...
Done
