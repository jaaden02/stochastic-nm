============================================================
FOKKER-PLANCK SETUP VALIDATION
============================================================
Grid: 220×70×20 (0.3 M cells)
Resolutions: dx=1.598 (Req < 0.8), dz=0.072, dφ=0.331
Initial Pos: x=0.0, z=-2.0, φ=-0.50π
Initial Widths: σx=0.05, σz=0.050, σφ=0.100
----------------------------------------
============================================================
VECTORIZED 3D FOKKER-PLANCK SOLVER
============================================================
Grid: 220×70×20 = 308,000 cells
Resolution: dx=1.598, dz=0.072, dφ=0.331
x in [0, 350], z in [-5, 0], φ in [0, 6.283185307179586]
Diffusion D0 = 0.01
Initial ∫f = 1.000000

Time: t ∈ [0, 1600], dt=1.0000e-01, Nt=16001
Total Memory needed: 19.71 GB (float32)
------------------------------
CFL Stability Analysis (dt = 1.00e-01)
------------------------------
Advection Limits (dt < ...):
  X:   7.61e+00 (v=2.10e-01)
  Z:   6.59e-01 (v=1.10e-01)
  Phi: 5.44e+00 (v=6.08e-02) <--- Check this!
Diffusion Limits (dt < ...):
  Phi: 5.47e+00
------------------------------
Combined Max Stable dt: 4.96e-01
✅ STABLE

Allocating solution array: 189.2 MB
Starting Solver. BCs: X='open', Z='open'. Steps: 16001
Step 1/16000, t=0.0000, ∫f=1.000000
Step 100/16000, t=9.9000, ∫f=1.000000
Step 200/16000, t=19.9000, ∫f=1.000000
Step 300/16000, t=29.9000, ∫f=1.000000
Step 400/16000, t=39.9000, ∫f=1.000000
Step 500/16000, t=49.9000, ∫f=0.999998
Step 600/16000, t=59.9000, ∫f=0.999974
Step 700/16000, t=69.9000, ∫f=0.999822
Step 800/16000, t=79.9000, ∫f=0.999201
Step 900/16000, t=89.9000, ∫f=0.997440
Step 1000/16000, t=99.9000, ∫f=0.993474
Step 1100/16000, t=109.9000, ∫f=0.986170
Step 1200/16000, t=119.9000, ∫f=0.974699
Step 1300/16000, t=129.9000, ∫f=0.958363
Step 1400/16000, t=139.9000, ∫f=0.937412
Step 1500/16000, t=149.9000, ∫f=0.912519
Step 1600/16000, t=159.9000, ∫f=0.884225
Step 1700/16000, t=169.9000, ∫f=0.853995
Step 1800/16000, t=179.9000, ∫f=0.822751
Step 1900/16000, t=189.9000, ∫f=0.791180
Step 2000/16000, t=199.9000, ∫f=0.760500
Step 2100/16000, t=209.9000, ∫f=0.730914
Step 2200/16000, t=219.9000, ∫f=0.702798
Step 2300/16000, t=229.9000, ∫f=0.676718
Step 2400/16000, t=239.9000, ∫f=0.652362
Step 2500/16000, t=249.9000, ∫f=0.629890
Step 2600/16000, t=259.9000, ∫f=0.609419
Step 2700/16000, t=269.9000, ∫f=0.590515
Step 2800/16000, t=279.9000, ∫f=0.573264
Step 2900/16000, t=289.9000, ∫f=0.557562
Step 3000/16000, t=299.9000, ∫f=0.543053
Step 3100/16000, t=309.9000, ∫f=0.529802
Step 3200/16000, t=319.9000, ∫f=0.517624
Step 3300/16000, t=329.9000, ∫f=0.506288
Step 3400/16000, t=339.9000, ∫f=0.495846
Step 3500/16000, t=349.9000, ∫f=0.486096
Step 3600/16000, t=359.9000, ∫f=0.476923
Step 3700/16000, t=369.9000, ∫f=0.468359
Step 3800/16000, t=379.9000, ∫f=0.460217
Step 3900/16000, t=389.9000, ∫f=0.452465
Step 4000/16000, t=399.9000, ∫f=0.445116
Step 4100/16000, t=409.9000, ∫f=0.438014
Step 4200/16000, t=419.9000, ∫f=0.431178
Step 4300/16000, t=429.9000, ∫f=0.424601
Step 4400/16000, t=439.9000, ∫f=0.418167
Step 4500/16000, t=449.9000, ∫f=0.411921
Step 4600/16000, t=459.9000, ∫f=0.405836
Step 4700/16000, t=469.9000, ∫f=0.399842
Step 4800/16000, t=479.9000, ∫f=0.393989
Step 4900/16000, t=489.9000, ∫f=0.388235
Step 5000/16000, t=499.9000, ∫f=0.382546
Step 5100/16000, t=509.9000, ∫f=0.376974
Step 5200/16000, t=519.9000, ∫f=0.371461
Step 5300/16000, t=529.9000, ∫f=0.366008
Step 5400/16000, t=539.9000, ∫f=0.360653
Step 5500/16000, t=549.9000, ∫f=0.355339
Step 5600/16000, t=559.9000, ∫f=0.350087
Step 5700/16000, t=569.9000, ∫f=0.344918
Step 5800/16000, t=579.9000, ∫f=0.339783
Step 5900/16000, t=589.9000, ∫f=0.334715
Step 6000/16000, t=599.9000, ∫f=0.329720
Step 6100/16000, t=609.9000, ∫f=0.324757
Step 6200/16000, t=619.9000, ∫f=0.319869
Step 6300/16000, t=629.9000, ∫f=0.315041
Step 6400/16000, t=639.9000, ∫f=0.310252
Step 6500/16000, t=649.9000, ∫f=0.305541
Step 6600/16000, t=659.9000, ∫f=0.300881
Step 6700/16000, t=669.9000, ∫f=0.296269
Step 6800/16000, t=679.9000, ∫f=0.291735
Step 6900/16000, t=689.9000, ∫f=0.287246
Step 7000/16000, t=699.9000, ∫f=0.282813
Step 7100/16000, t=709.9000, ∫f=0.278457
Step 7200/16000, t=719.9000, ∫f=0.274143
Step 7300/16000, t=729.9000, ∫f=0.269892
Step 7400/16000, t=739.9000, ∫f=0.265713
Step 7500/16000, t=749.9000, ∫f=0.261576
Step 7600/16000, t=759.9000, ∫f=0.257509
Step 7700/16000, t=769.9000, ∫f=0.253505
Step 7800/16000, t=779.9000, ∫f=0.249546
Step 7900/16000, t=789.9000, ∫f=0.245661
Step 8000/16000, t=799.9000, ∫f=0.241831
Step 8100/16000, t=809.9000, ∫f=0.238050
Step 8200/16000, t=819.9000, ∫f=0.234342
Step 8300/16000, t=829.9000, ∫f=0.230683
Step 8400/16000, t=839.9000, ∫f=0.227077
Step 8500/16000, t=849.9000, ∫f=0.223540
Step 8600/16000, t=859.9000, ∫f=0.220048
Step 8700/16000, t=869.9000, ∫f=0.216612
Step 8800/16000, t=879.9000, ∫f=0.213240
Step 8900/16000, t=889.9000, ∫f=0.209909
Step 9000/16000, t=899.9000, ∫f=0.206637
Step 9100/16000, t=909.9000, ∫f=0.203422
Step 9200/16000, t=919.9000, ∫f=0.200247
Step 9300/16000, t=929.9000, ∫f=0.197132
Step 9400/16000, t=939.9000, ∫f=0.194066
Step 9500/16000, t=949.9000, ∫f=0.191041
Step 9600/16000, t=959.9000, ∫f=0.188074
Step 9700/16000, t=969.9000, ∫f=0.185149
Step 9800/16000, t=979.9000, ∫f=0.182267
Step 9900/16000, t=989.9000, ∫f=0.179440
Step 10000/16000, t=999.9000, ∫f=0.176650
Step 10100/16000, t=1009.9000, ∫f=0.173904
Step 10200/16000, t=1019.9000, ∫f=0.171210
Step 10300/16000, t=1029.9000, ∫f=0.168548
Step 10400/16000, t=1039.9000, ∫f=0.165931
Step 10500/16000, t=1049.9000, ∫f=0.163360
Step 10600/16000, t=1059.9000, ∫f=0.160821
Step 10700/16000, t=1069.9000, ∫f=0.158327
Step 10800/16000, t=1079.9000, ∫f=0.155874
Step 10900/16000, t=1089.9000, ∫f=0.153451
Step 11000/16000, t=1099.9000, ∫f=0.151074
Step 11100/16000, t=1109.9000, ∫f=0.148731
Step 11200/16000, t=1119.9000, ∫f=0.146420
Step 11300/16000, t=1129.9000, ∫f=0.144153
Step 11400/16000, t=1139.9000, ∫f=0.141915
Step 11500/16000, t=1149.9000, ∫f=0.139711
Step 11600/16000, t=1159.9000, ∫f=0.137548
Step 11700/16000, t=1169.9000, ∫f=0.135411
Step 11800/16000, t=1179.9000, ∫f=0.133309
Step 11900/16000, t=1189.9000, ∫f=0.131244
Step 12000/16000, t=1199.9000, ∫f=0.129203
Step 12100/16000, t=1209.9000, ∫f=0.127199
Step 12200/16000, t=1219.9000, ∫f=0.125227
Step 12300/16000, t=1229.9000, ∫f=0.123279
Step 12400/16000, t=1239.9000, ∫f=0.121367
Step 12500/16000, t=1249.9000, ∫f=0.119483
Step 12600/16000, t=1259.9000, ∫f=0.117625
Step 12700/16000, t=1269.9000, ∫f=0.115801
Step 12800/16000, t=1279.9000, ∫f=0.114002
Step 12900/16000, t=1289.9000, ∫f=0.112229
Step 13000/16000, t=1299.9000, ∫f=0.110488
Step 13100/16000, t=1309.9000, ∫f=0.108770
Step 13200/16000, t=1319.9000, ∫f=0.107079
Step 13300/16000, t=1329.9000, ∫f=0.105418
Step 13400/16000, t=1339.9000, ∫f=0.103777
Step 13500/16000, t=1349.9000, ∫f=0.102165
Step 13600/16000, t=1359.9000, ∫f=0.100579
Step 13700/16000, t=1369.9000, ∫f=0.099013
Step 13800/16000, t=1379.9000, ∫f=0.097475
Step 13900/16000, t=1389.9000, ∫f=0.095960
Step 14000/16000, t=1399.9000, ∫f=0.094466
Step 14100/16000, t=1409.9000, ∫f=0.092999
Step 14200/16000, t=1419.9000, ∫f=0.091553
Step 14300/16000, t=1429.9000, ∫f=0.090128
Step 14400/16000, t=1439.9000, ∫f=0.088729
Step 14500/16000, t=1449.9000, ∫f=0.087348
Step 14600/16000, t=1459.9000, ∫f=0.085989
Step 14700/16000, t=1469.9000, ∫f=0.084654
Step 14800/16000, t=1479.9000, ∫f=0.083335
Step 14900/16000, t=1489.9000, ∫f=0.082039
Step 15000/16000, t=1499.9000, ∫f=0.080765
Step 15100/16000, t=1509.9000, ∫f=0.079507
Step 15200/16000, t=1519.9000, ∫f=0.078271
Step 15300/16000, t=1529.9000, ∫f=0.077055
Step 15400/16000, t=1539.9000, ∫f=0.075855
Step 15500/16000, t=1549.9000, ∫f=0.074676
Step 15600/16000, t=1559.9000, ∫f=0.073515
Step 15700/16000, t=1569.9000, ∫f=0.072370
Step 15800/16000, t=1579.9000, ∫f=0.071246
Step 15900/16000, t=1589.9000, ∫f=0.070137
Step 16000/16000, t=1599.9000, ∫f=0.069046

============================================================
✓ Done! Solution shape: (161, 220, 70, 20)
Final ∫f = 0.069046
Computation time: 915.18 seconds
   (0.0572 sec/step, 5.39 Mcells/sec)
============================================================

Generating summary plots...
Done
