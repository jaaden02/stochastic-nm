============================================================
FOKKER-PLANCK SETUP VALIDATION
============================================================
Grid: 150×40×40 (0.2 M cells)
Resolutions: dx=1.208 (Req < 0.8), dz=0.128, dφ=0.161
Initial Pos: x=0.0, z=-2.0, φ=-0.50π
Initial Widths: σx=0.10, σz=0.256, σφ=0.322
----------------------------------------
============================================================
VECTORIZED 3D FOKKER-PLANCK SOLVER
============================================================
Grid: 150×40×40 = 240,000 cells
Resolution: dx=1.208, dz=0.128, dφ=0.161
x in [0, 180], z in [-5, 0], φ in [-1.5707963267948966, 4.71238898038469]
Diffusion D0 = 1e-05
Initial ∫f = 1.000000

Time: t ∈ [0, 1200], dt=1.0000e-01, Nt=12001
Total Memory needed: 11.52 GB (float32)
------------------------------
CFL Stability Analysis (dt = 1.00e-01)
------------------------------
Advection Limits (dt < ...):
  X:   5.75e+00 (v=2.10e-01)
  Z:   1.17e+00 (v=1.10e-01)
  Phi: 2.65e+00 (v=6.08e-02) <--- Check this!
Diffusion Limits (dt < ...):
  Phi: 1.30e+03
------------------------------
Combined Max Stable dt: 7.09e-01
✅ STABLE

Allocating solution array: 110.8 MB
Starting Solver. BCs: X='open', Z='open'. Steps: 12001
Step 1/12000, t=0.0000, ∫f=1.000000
Step 100/12000, t=9.9000, ∫f=1.000000
Step 200/12000, t=19.9000, ∫f=0.999999
Step 300/12000, t=29.9000, ∫f=0.999992
Step 400/12000, t=39.9000, ∫f=0.999948
Step 500/12000, t=49.9000, ∫f=0.999808
Step 600/12000, t=59.9000, ∫f=0.999453
Step 700/12000, t=69.9000, ∫f=0.998743
Step 800/12000, t=79.9000, ∫f=0.997490
Step 900/12000, t=89.9000, ∫f=0.995514
Step 1000/12000, t=99.9000, ∫f=0.992636
Step 1100/12000, t=109.9000, ∫f=0.988699
Step 1200/12000, t=119.9000, ∫f=0.983593
Step 1300/12000, t=129.9000, ∫f=0.977235
Step 1400/12000, t=139.9000, ∫f=0.969600
Step 1500/12000, t=149.9000, ∫f=0.960691
Step 1600/12000, t=159.9000, ∫f=0.950563
Step 1700/12000, t=169.9000, ∫f=0.939287
Step 1800/12000, t=179.9000, ∫f=0.926971
Step 1900/12000, t=189.9000, ∫f=0.913730
Step 2000/12000, t=199.9000, ∫f=0.899696
Step 2100/12000, t=209.9000, ∫f=0.885002
Step 2200/12000, t=219.9000, ∫f=0.869785
Step 2300/12000, t=229.9000, ∫f=0.854172
Step 2400/12000, t=239.9000, ∫f=0.838290
Step 2500/12000, t=249.9000, ∫f=0.822250
Step 2600/12000, t=259.9000, ∫f=0.806157
Step 2700/12000, t=269.9000, ∫f=0.790104
Step 2800/12000, t=279.9000, ∫f=0.774171
Step 2900/12000, t=289.9000, ∫f=0.758429
Step 3000/12000, t=299.9000, ∫f=0.742936
Step 3100/12000, t=309.9000, ∫f=0.727742
Step 3200/12000, t=319.9000, ∫f=0.712886
Step 3300/12000, t=329.9000, ∫f=0.698398
Step 3400/12000, t=339.9000, ∫f=0.684303
Step 3500/12000, t=349.9000, ∫f=0.670617
Step 3600/12000, t=359.9000, ∫f=0.657349
Step 3700/12000, t=369.9000, ∫f=0.644506
Step 3800/12000, t=379.9000, ∫f=0.632089
Step 3900/12000, t=389.9000, ∫f=0.620093
Step 4000/12000, t=399.9000, ∫f=0.608512
Step 4100/12000, t=409.9000, ∫f=0.597338
Step 4200/12000, t=419.9000, ∫f=0.586560
Step 4300/12000, t=429.9000, ∫f=0.576164
Step 4400/12000, t=439.9000, ∫f=0.566135
Step 4500/12000, t=449.9000, ∫f=0.556460
Step 4600/12000, t=459.9000, ∫f=0.547121
Step 4700/12000, t=469.9000, ∫f=0.538102
Step 4800/12000, t=479.9000, ∫f=0.529386
Step 4900/12000, t=489.9000, ∫f=0.520957
Step 5000/12000, t=499.9000, ∫f=0.512797
Step 5100/12000, t=509.9000, ∫f=0.504891
Step 5200/12000, t=519.9000, ∫f=0.497223
Step 5300/12000, t=529.9000, ∫f=0.489777
Step 5400/12000, t=539.9000, ∫f=0.482539
Step 5500/12000, t=549.9000, ∫f=0.475494
Step 5600/12000, t=559.9000, ∫f=0.468629
Step 5700/12000, t=569.9000, ∫f=0.461932
Step 5800/12000, t=579.9000, ∫f=0.455390
Step 5900/12000, t=589.9000, ∫f=0.448992
Step 6000/12000, t=599.9000, ∫f=0.442729
Step 6100/12000, t=609.9000, ∫f=0.436590
Step 6200/12000, t=619.9000, ∫f=0.430566
Step 6300/12000, t=629.9000, ∫f=0.424650
Step 6400/12000, t=639.9000, ∫f=0.418834
Step 6500/12000, t=649.9000, ∫f=0.413112
Step 6600/12000, t=659.9000, ∫f=0.407477
Step 6700/12000, t=669.9000, ∫f=0.401924
Step 6800/12000, t=679.9000, ∫f=0.396448
Step 6900/12000, t=689.9000, ∫f=0.391046
Step 7000/12000, t=699.9000, ∫f=0.385712
Step 7100/12000, t=709.9000, ∫f=0.380445
Step 7200/12000, t=719.9000, ∫f=0.375240
Step 7300/12000, t=729.9000, ∫f=0.370096
Step 7400/12000, t=739.9000, ∫f=0.365011
Step 7500/12000, t=749.9000, ∫f=0.359983
Step 7600/12000, t=759.9000, ∫f=0.355009
Step 7700/12000, t=769.9000, ∫f=0.350091
Step 7800/12000, t=779.9000, ∫f=0.345225
Step 7900/12000, t=789.9000, ∫f=0.340412
Step 8000/12000, t=799.9000, ∫f=0.335651
Step 8100/12000, t=809.9000, ∫f=0.330941
Step 8200/12000, t=819.9000, ∫f=0.326283
Step 8300/12000, t=829.9000, ∫f=0.321677
Step 8400/12000, t=839.9000, ∫f=0.317121
Step 8500/12000, t=849.9000, ∫f=0.312617
Step 8600/12000, t=859.9000, ∫f=0.308165
Step 8700/12000, t=869.9000, ∫f=0.303764
Step 8800/12000, t=879.9000, ∫f=0.299415
Step 8900/12000, t=889.9000, ∫f=0.295118
Step 9000/12000, t=899.9000, ∫f=0.290873
Step 9100/12000, t=909.9000, ∫f=0.286681
Step 9200/12000, t=919.9000, ∫f=0.282542
Step 9300/12000, t=929.9000, ∫f=0.278456
Step 9400/12000, t=939.9000, ∫f=0.274423
Step 9500/12000, t=949.9000, ∫f=0.270443
Step 9600/12000, t=959.9000, ∫f=0.266517
Step 9700/12000, t=969.9000, ∫f=0.262644
Step 9800/12000, t=979.9000, ∫f=0.258825
Step 9900/12000, t=989.9000, ∫f=0.255060
Step 10000/12000, t=999.9000, ∫f=0.251349
Step 10100/12000, t=1009.9000, ∫f=0.247692
Step 10200/12000, t=1019.9000, ∫f=0.244088
Step 10300/12000, t=1029.9000, ∫f=0.240538
Step 10400/12000, t=1039.9000, ∫f=0.237042
Step 10500/12000, t=1049.9000, ∫f=0.233599
Step 10600/12000, t=1059.9000, ∫f=0.230208
Step 10700/12000, t=1069.9000, ∫f=0.226871
Step 10800/12000, t=1079.9000, ∫f=0.223586
Step 10900/12000, t=1089.9000, ∫f=0.220354
Step 11000/12000, t=1099.9000, ∫f=0.217173
Step 11100/12000, t=1109.9000, ∫f=0.214044
Step 11200/12000, t=1119.9000, ∫f=0.210965
Step 11300/12000, t=1129.9000, ∫f=0.207938
Step 11400/12000, t=1139.9000, ∫f=0.204960
Step 11500/12000, t=1149.9000, ∫f=0.202032
Step 11600/12000, t=1159.9000, ∫f=0.199153
Step 11700/12000, t=1169.9000, ∫f=0.196323
Step 11800/12000, t=1179.9000, ∫f=0.193540
Step 11900/12000, t=1189.9000, ∫f=0.190806
Step 12000/12000, t=1199.9000, ∫f=0.188118

============================================================
✓ Done! Solution shape: (121, 150, 40, 40)
Final ∫f = 0.188118
Computation time: 522.29 seconds
   (0.0435 sec/step, 5.51 Mcells/sec)
============================================================

Generating summary plots...
Done
