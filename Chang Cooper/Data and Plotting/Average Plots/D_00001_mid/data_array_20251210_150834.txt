============================================================
FOKKER-PLANCK SETUP VALIDATION
============================================================
Grid: 150×80×50 (0.6 M cells)
Resolutions: dx=0.671 (Req < 0.8), dz=0.063, dφ=0.128
Initial Pos: x=0.0, z=-2.0, φ=-0.50π
Initial Widths: σx=0.10, σz=0.063, σφ=0.256
----------------------------------------
============================================================
VECTORIZED 3D FOKKER-PLANCK SOLVER
============================================================
Grid: 150×80×50 = 600,000 cells
Resolution: dx=0.671, dz=0.063, dφ=0.128
x in [0, 100], z in [-5, 0], φ in [-1.5707963267948966, 4.71238898038469]
Diffusion D0 = 1e-05
Initial ∫f = 1.000000

Time: t ∈ [0, 1000], dt=1.0000e-01, Nt=10001
Total Memory needed: 24.00 GB (float32)
------------------------------
CFL Stability Analysis (dt = 1.00e-01)
------------------------------
Advection Limits (dt < ...):
  X:   3.20e+00 (v=2.10e-01)
  Z:   5.75e-01 (v=1.10e-01)
  Phi: 2.11e+00 (v=6.08e-02) <--- Check this!
Diffusion Limits (dt < ...):
  Phi: 8.22e+02
------------------------------
Combined Max Stable dt: 3.96e-01
✅ STABLE

Allocating solution array: 231.2 MB
Starting Solver. BCs: X='open', Z='open'. Steps: 10001
Step 1/10000, t=0.0000, ∫f=1.000000
Step 100/10000, t=9.9000, ∫f=1.000000
Step 200/10000, t=19.9000, ∫f=1.000000
Step 300/10000, t=29.9000, ∫f=1.000000
Step 400/10000, t=39.9000, ∫f=1.000000
Step 500/10000, t=49.9000, ∫f=1.000000
Step 600/10000, t=59.9000, ∫f=1.000000
Step 700/10000, t=69.9000, ∫f=1.000000
Step 800/10000, t=79.9000, ∫f=0.999998
Step 900/10000, t=89.9000, ∫f=0.999988
Step 1000/10000, t=99.9000, ∫f=0.999954
Step 1100/10000, t=109.9000, ∫f=0.999856
Step 1200/10000, t=119.9000, ∫f=0.999631
Step 1300/10000, t=129.9000, ∫f=0.999168
Step 1400/10000, t=139.9000, ∫f=0.998339
Step 1500/10000, t=149.9000, ∫f=0.996976
Step 1600/10000, t=159.9000, ∫f=0.994909
Step 1700/10000, t=169.9000, ∫f=0.991984
Step 1800/10000, t=179.9000, ∫f=0.988045
Step 1900/10000, t=189.9000, ∫f=0.983014
Step 2000/10000, t=199.9000, ∫f=0.976806
Step 2100/10000, t=209.9000, ∫f=0.969429
Step 2200/10000, t=219.9000, ∫f=0.960894
Step 2300/10000, t=229.9000, ∫f=0.951277
Step 2400/10000, t=239.9000, ∫f=0.940661
Step 2500/10000, t=249.9000, ∫f=0.929170
Step 2600/10000, t=259.9000, ∫f=0.916920
Step 2700/10000, t=269.9000, ∫f=0.904053
Step 2800/10000, t=279.9000, ∫f=0.890699
Step 2900/10000, t=289.9000, ∫f=0.876981
Step 3000/10000, t=299.9000, ∫f=0.863027
Step 3100/10000, t=309.9000, ∫f=0.848940
Step 3200/10000, t=319.9000, ∫f=0.834822
Step 3300/10000, t=329.9000, ∫f=0.820759
Step 3400/10000, t=339.9000, ∫f=0.806821
Step 3500/10000, t=349.9000, ∫f=0.793075
Step 3600/10000, t=359.9000, ∫f=0.779568
Step 3700/10000, t=369.9000, ∫f=0.766341
Step 3800/10000, t=379.9000, ∫f=0.753430
Step 3900/10000, t=389.9000, ∫f=0.740852
Step 4000/10000, t=399.9000, ∫f=0.728628
Step 4100/10000, t=409.9000, ∫f=0.716767
Step 4200/10000, t=419.9000, ∫f=0.705273
Step 4300/10000, t=429.9000, ∫f=0.694149
Step 4400/10000, t=439.9000, ∫f=0.683388
Step 4500/10000, t=449.9000, ∫f=0.672986
Step 4600/10000, t=459.9000, ∫f=0.662934
Step 4700/10000, t=469.9000, ∫f=0.653220
Step 4800/10000, t=479.9000, ∫f=0.643832
Step 4900/10000, t=489.9000, ∫f=0.634757
Step 5000/10000, t=499.9000, ∫f=0.625979
Step 5100/10000, t=509.9000, ∫f=0.617484
Step 5200/10000, t=519.9000, ∫f=0.609257
Step 5300/10000, t=529.9000, ∫f=0.601281
Step 5400/10000, t=539.9000, ∫f=0.593543
Step 5500/10000, t=549.9000, ∫f=0.586027
Step 5600/10000, t=559.9000, ∫f=0.578718
Step 5700/10000, t=569.9000, ∫f=0.571602
Step 5800/10000, t=579.9000, ∫f=0.564665
Step 5900/10000, t=589.9000, ∫f=0.557896
Step 6000/10000, t=599.9000, ∫f=0.551281
Step 6100/10000, t=609.9000, ∫f=0.544808
Step 6200/10000, t=619.9000, ∫f=0.538467
Step 6300/10000, t=629.9000, ∫f=0.532247
Step 6400/10000, t=639.9000, ∫f=0.526139
Step 6500/10000, t=649.9000, ∫f=0.520134
Step 6600/10000, t=659.9000, ∫f=0.514223
Step 6700/10000, t=669.9000, ∫f=0.508399
Step 6800/10000, t=679.9000, ∫f=0.502655
Step 6900/10000, t=689.9000, ∫f=0.496984
Step 7000/10000, t=699.9000, ∫f=0.491381
Step 7100/10000, t=709.9000, ∫f=0.485840
Step 7200/10000, t=719.9000, ∫f=0.480356
Step 7300/10000, t=729.9000, ∫f=0.474925
Step 7400/10000, t=739.9000, ∫f=0.469543
Step 7500/10000, t=749.9000, ∫f=0.464207
Step 7600/10000, t=759.9000, ∫f=0.458914
Step 7700/10000, t=769.9000, ∫f=0.453660
Step 7800/10000, t=779.9000, ∫f=0.448444
Step 7900/10000, t=789.9000, ∫f=0.443262
Step 8000/10000, t=799.9000, ∫f=0.438112
Step 8100/10000, t=809.9000, ∫f=0.432992
Step 8200/10000, t=819.9000, ∫f=0.427896
Step 8300/10000, t=829.9000, ∫f=0.422821
Step 8400/10000, t=839.9000, ∫f=0.417763
Step 8500/10000, t=849.9000, ∫f=0.412707
Step 8600/10000, t=859.9000, ∫f=0.407651
Step 8700/10000, t=869.9000, ∫f=0.402575
Step 8800/10000, t=879.9000, ∫f=0.397455
Step 8900/10000, t=889.9000, ∫f=0.392291
Step 9000/10000, t=899.9000, ∫f=0.387009
Step 9100/10000, t=909.9000, ∫f=0.381630
Step 9200/10000, t=919.9000, ∫f=0.376061
Step 9300/10000, t=929.9000, ∫f=0.370265
Step 9400/10000, t=939.9000, ∫f=0.364244
Step 9500/10000, t=949.9000, ∫f=0.357792
Step 9600/10000, t=959.9000, ∫f=0.351056
Step 9700/10000, t=969.9000, ∫f=0.343754
Step 9800/10000, t=979.9000, ∫f=0.335949
Step 9900/10000, t=989.9000, ∫f=0.327637
Step 10000/10000, t=999.9000, ∫f=0.318473

============================================================
✓ Done! Solution shape: (101, 150, 80, 50)
Final ∫f = 0.318473
Computation time: 1012.07 seconds
   (0.1012 sec/step, 5.93 Mcells/sec)
============================================================
Done
